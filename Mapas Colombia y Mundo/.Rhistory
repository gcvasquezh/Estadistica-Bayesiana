# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="cyan",high="darkmagenta",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="forestgreen",high="darkmagenta",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="red",high="lightgreen",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="gold",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="yellow",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="darkgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="green",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="red",high="lightgreen",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
setwd("C:/Users/gcvh2/Documents/UNAL/7. 2023 - 2S/Estadística Bayesiana/Caso de estudio 2/Mapas Colombia y Mundo")
#Aquí guardo área y poligonos para que R me logre graficar los departamentos
deptoshp <- st_read("MGN_DPTO_POLITICO.shp",quiet=TRUE)
#Usamos Left join para que haga el cruce por código de departamento y deje todas las columnas
#de deptoshp
mapdeptos <- deptoshp %>%
left_join(punto1,by=c("DPTO_CCDGO"="CodDep")) %>%
select(!(Departamento))
#Ahora mundoshp es un mapa de todo el mundo y estamos filtrando los que limitan con locombia
mundoshp <- st_read("admin00.shp",quiet=TRUE)
mundocol <- mundoshp %>%
filter(CNTRY_NAME %in% c("Peru","Brazil","Venezuela","Ecuador","Panama"))
#Box calcula el rectangulo que envuelve a todo el conjunto de media_pun_tabla mapdeptos (locombia)
#box deja un poquito a la izquierda porque tiene en cuenta a SAN ANDRES
box <- st_bbox(mapdeptos)
box
mitema <- theme(legend.title=element_text(hjust = 0.5,color = "black"),
legend.text=element_text(hjust = 0.5),
plot.title=element_text(face="bold",size=15,vjust=0.5,hjust=0.5,color="black"),
axis.title.x = element_text(hjust = 0.5, color = "black"),
axis.title.y = element_text(hjust = 0.5, color = "black"))
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(media_pun > quantile(media_pun, probs = 0.75, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de Incidencia de la pobreza monetaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=IPM),col="darkgray",linetype="solid") + #aes fill='IPM', el color de relleno dependera de 'IPM'
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(IPM < quantile(IPM, probs = 0.25, na.rm = TRUE),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Incidencia de\nla Pobreza\nMonetaria\nen 2018") + #Nombre Ejes
scale_fill_gradient(low="lightgreen",high="red",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
setwd("C:/Users/gcvh2/Documents/UNAL/7. 2023 - 2S/Estadística Bayesiana/Caso de estudio 2/Mapas Colombia y Mundo")
#Aquí guardo área y poligonos para que R me logre graficar los departamentos
mupshp <- st_read("MGN_MPIO_POLITICO.shp",quiet=TRUE)
mupshp <- mupshp %>%
mutate(CodMup = paste(DPTO_CCDGO, MPIO_CCDGO, sep = ""))
#Usamos Left join para que haga el cruce por código de departamento y deje todas las columnas
#de deptoshp
mapmup <- mupshp %>%
left_join(punto2,by=c("CodMup"="CodMup")) %>%
select(!c(CodDepto,Departamento,Municipio))
#Box calcula el rectangulo que envuelve a todo el conjunto de media_pun_tabla mapdeptos (locombia)
#box deja un poquito a la izquierda porque tiene en cuenta a SAN ANDRES
box <- st_bbox(mapmup)
box
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapmup,aes(fill=media_pun),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media del\nPuntaje\nGlobal") + #Nombre Ejes
scale_fill_gradient(low="lightpink",high="blue",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica cobertura neta secundaria
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapmup,aes(fill=CNS),col="darkgray",linetype="solid") + #aes fill=media_pun, el color de relleno dependera de media_pun
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Cobertura\nNeta\nSecundaria") + #Nombre Ejes
scale_fill_gradient(low="lightpink",high="blue",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=Media_post),col="darkgray",linetype="solid") + #aes fill=Media_post, el color de relleno dependera de Media_post
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(!is.na(Media_post),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media posterior de\nlos departamentos\nsin IPM") + #Nombre Ejes
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
mapdeptos <- deptoshp %>%
left_join(mapita_punto9,by=c("DPTO_CCDGO"="CodDep")) %>%
select(!(Departamento))
#Box calcula el rectangulo que envuelve a todo el conjunto de media_pun_tabla mapdeptos (locombia)
#box deja un poquito a la izquierda porque tiene en cuenta a SAN ANDRES
box <- st_bbox(mapdeptos)
box
# Gráfica de media puntaje global
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=Media_post),col="darkgray",linetype="solid") + #aes fill=Media_post, el color de relleno dependera de Media_post
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
geom_sf_text(data=mapdeptos,aes(label=ifelse(!is.na(Media_post),DPTO_CNMBR,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Colombia",fill="Media posterior de\nlos departamentos\nsin IPM") + #Nombre Ejes
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) + #Le damos colores de blanco a azul
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="blue",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
choco <- mupshp %>%
left_join(mapita_punto11,by=c("CodMup"="CodMup")) %>%
filter(CodDepto=="27")
box <- st_bbox(choco)
box
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=3.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=1.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=2,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=1.9,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=1.8,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=1.7,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=2.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mupshp) +
geom_sf(data=choco,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=choco,aes(label=ifelse((CodMup==27615 | CodMup==27150),Municipio,"")),col="black",
fontface="bold",size=3,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Choco",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) +
theme(panel.background=element_rect(fill="lightblue")) + mitema
### Guainia ####
guainia <- mupshp %>%
left_join(mapita_punto11,by=c("CodMup"="CodMup")) %>%
filter(CodDepto=="94")
box <- st_bbox(guainia)
box
ggplot() +
geom_sf(data=mupshp) +
geom_sf(data=guainia,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=guainia,aes(label=ifelse((CodMup==94343 | CodMup==94001 | CodMup==94888),Municipio,"")),col="black",
fontface="bold",size=3.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Guainia",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) + mitema
View(mapita_punto11)
# Medias posteriores
mapita_punto11 <- cbind(punto2,c(rep(NA,574),colMeans(chain_M5$THETA[,575:605]),
c(rep(NA,490),colMeans(chain_M5$THETA[,1096:1101]),
c(rep(NA,11)))))
mapita_punto11 <- mapita_punto11[,c(1,2,3,4,7)]
colnames(mapita_punto11)[5]<-"Media_post"
mapita_punto11 <- rbind(mapita_punto11[1:1099,],
c("94","GUAINIA","94884","PUERTO COLOMBIA",NA),
c("94","GUAINIA","94885","LA GUADALUPE",NA),
c("94","GUAINIA","94886","CACAHUAL",NA),
mapita_punto11[1100:1112,])
mapita_punto11$Media_post <- as.numeric(mapita_punto11$Media_post)
### Guainia ####
guainia <- mupshp %>%
left_join(mapita_punto11,by=c("CodMup"="CodMup")) %>%
filter(CodDepto=="94")
box <- st_bbox(guainia)
box
ggplot() +
geom_sf(data=mupshp) +
geom_sf(data=guainia,aes(fill=Media_post),col="darkgray",linetype="solid") +
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) +
geom_sf_text(data=guainia,aes(label=ifelse((CodMup==94343 | CodMup==94001 | CodMup==94888),Municipio,"")),col="black",
fontface="bold",size=3.5,fun.geometry=function(x) sf::st_centroid(x)) +
labs(x="Longitud",y="Latitud",title="Guainia",fill="Media posterior de\nMunicipio sin CSN") +
scale_fill_gradient(low="yellow",high="darkgreen",n.breaks=5) + mitema
mapdeptos <- deptoshp %>%
left_join(mapita_punto8,by=c("DPTO_CCDGO"="CodDep")) %>%
select(!(Departamento))
#Box calcula el rectangulo que envuelve a todo el conjunto de media_pun_tabla mapdeptos (locombia)
#box deja un poquito a la izquierda porque tiene en cuenta a SAN ANDRES
box <- st_bbox(mapdeptos)
box
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("lightgreen","lightseagreen","lightsalmon","lightcyan","lightpink")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("cornflowerblue", "mediumseagreen", "tomato", "darkorange", "mediumpurple")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("steelblue", "olivedrab", "tomato", "darkorange", "mediumpurple")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("royalblue", "limegreen", "red", "darkorange", "mediumorchid")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("blue", "limegreen", "red", "darkorange", "mediumorchid")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapdeptos,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("blue", "darkgreen", "red", "darkorange", "mediumorchid")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
mapmup <- mupshp %>%
left_join(mapita_punto10,by=c("CodMup"="CodMup")) %>%
select(!c(CodDepto,Departamento,Municipio))
#Box calcula el rectangulo que envuelve a todo el conjunto de media_pun_tabla mapdeptos (locombia)
#box deja un poquito a la izquierda porque tiene en cuenta a SAN ANDRES
box <- st_bbox(mapmup)
box
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapmup,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("blue", "darkgreen", "red", "darkorange", "darkblue", "gold", "dodgerblue", "darkviolet")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
# Gráfica
ggplot() +
geom_sf(data=mundocol) +
geom_sf(data=mapmup,aes(fill=xi),col="darkgray",linetype="solid") + #aes fill=xi, el color de relleno dependera de xi
coord_sf(xlim=c(box$xmin,box$xmax),ylim=c(box$ymin,box$ymax),expand=FALSE) + #Aqui centramos el mapa en locombia
labs(x="Longitud",y="Latitud",title="Colombia",fill="Grupos") + #Nombre Ejes
scale_fill_manual(values = c("darkgreen", "darkred", "red", "darkorange", "darkblue", "gold", "sienna", "darkviolet")) +
annotate("text", x=c(-74.5,-68,-78,-69,-78.5), y=c(-2.5,0,-1,9,9), colour="black",
label=c("Perú","Brasil","Ecuador","Venezuela","Panamá")) + #Coloco anotaciones en ciertas coordenadas
theme(panel.background=element_rect(fill="lightblue")) + mitema
View(mapita_punto11)
gc()
View(mapita_punto11)
save.image("~/UNAL/7. 2023 - 2S/Estadística Bayesiana/Caso de estudio 2/Datos finales/Datos_finales.RData")
